---
layout: post
title: "Design of Loss Function"
date: 2024-10-08
category: [In-depth exploration]
---

# 손실 함수의 종류 및 커스텀 Loss Function

## 평균 제곱 오차 MSE(Mean Squared Error)

MSE는 회귀 문제에서 자주 사용되는 손실함수. 예측값과 실제값의 차이를 제곱한 후, 그 평균을 구한다. 평균 제곱 오차의 값이 작을수록 모델의 예측이 실제값에 가까운 것을 의미한다. 다시 말해, MSE 값이 작을수록 알고리즘의 성능이 좋다고 볼 수 있다.
<img src='/public/img/241008/MSE.png' alt='Equation of MSE'>

- MSE는 오류를 제곱하기 때문에 큰 오류에 더 민감하게 반응하여 큰 오차를 줄이는 데 유리하다.
- 그래프로 표현해 본다고 가정하면, MSE는 오차가 커질수록 손실 함수 값이 빠르게 증가하는 특징을 가지고 있다.
  - 손실 함수의 크기는 오차의 제곱에 비례하여 변한다.
  - 미분값이 일정하지 않고 오차가 커질수록 미분값도 커진다.

## 교차 엔트로피 손실 Cross-Entropy Loss

교차 엔트로피 손실은 주로 분류 문제에서 사용된다. 이진 분류나 다중 클래스 분류에서 사용되며, 모델이 예측한 확률 분포와 실제 레이블 간의 차이를 계산한다.

아래의 수식은 이진 분류의 경우의 수식을 의미한다.
<img src='/public/img/241008/Cross-Entropy Loss.png' alt='Equation of Cross-Entropy Loss'>
예측확률과 실제 레이블을 가지고 계산을 하며, 크로스 엔트로피 손실함수는 모델이 실제 레이블에 대해 높은 확률을 예측할수록 값이 작아진다.

## Custom Loss Function

<a href='https://www.ine.pt/revstat/pdf/rs070102.pdf'>"Some Thoughts about the design of Loss Function"</a>이라는 제목의 논문에 "there is no need to stick to "standard" loss function such as the L2-loss"라는 문장이 있었다. 우리가 앞으로의 프로젝트나 모델을 사용한 연구 등을 진행할 때에 기존에 배운 손실 함수들 말고도 직접 커스텀하여 손실 함수를 정의할 수 있다는 내용이다.

연구 목적이나 특정 문제에 맞게 커스텀 손실 함수를 설계할 때, 데이터의 특성이나 특정한 모델 성능을 더 강화하기 위해 맞춤형 손실 함수를 정의할 수 있다. 커스텀 손실 함수가 필요한 경우는 아래와 같다:

- 특정 목적을 강화할 때:
  - 모델을 사용할 때 소수의 오차에 아주 민감해야 하는 경우, scaling을 통해 작은 오차에 더 집중할 수 있도록 커스텀할 수 있다.
- 비대칭적 데이터를 사용할 때:
  - 양성이나 음성 데이터 비율이 크게 다른 경우에서 특정 클래스의 오차를 더 중요하게 다룰 때, 특정 클래스의 오차에 집중할 수 있도록 직접 커스텀 가능하다.
- 멀티태스크 학습:
  - 여러 가지 다른 작업을 동시에 학습할 때, 각 작업마다 다른 손실 함수를 적용하여 학습이 이루어져야 할 필요성이 있다면 여러가지의 손실 함수를 합쳐 새로운 손실 함수를 정의할 수 있다.

### 커스텀 손실 함수 설계 방법
